<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>History - Pomodoro+</title>

    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Press Start 2P', cursive;
            height: 100vh;
            background-image: url('bg2.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            justify-content: center;
            align-items: center;
             color: #ff6f91;
        }

        .history-box {
            background-color: rgba(255, 255, 255, 0.95);
            padding: 25px 20px;
            border-radius: 30px;
            box-shadow: 12px 12px 25px rgba(0,0,0,0.1), -8px -8px 20px rgba(255,255,255,0.6);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .page-title {
            font-size: 18px;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
        }

        thead {
            background-color: #fbaecb;
            color: white;
        }

        thead th {
            padding: 10px;
            border: 2px solid #fff5f7;
        }

        tbody tr {
            background-color: #fff5f7;
        }

        tbody td {
            padding: 10px;
            text-align: center;
            border: 2px solid #ffe9f0;
        }

        tbody tr:nth-child(even) {
            background-color: #ffe9f0;
        }

        .no-history-message {
            font-size: 12px;
            color: #999;
            margin-top: 10px;
        }


 #menuToggle {
    position: fixed;
    top: 15px;
    left: 15px;
    width: 45px;
    height: 45px;
    cursor: pointer;
    z-index: 1100;
    transition: transform 0.3s ease;
  }

  #menuToggle:hover {
    transform: scale(1.1) rotate(3deg);
    size:30px;
  }

#sidebar {
  position: fixed;
  top: 0;
  left: -260px;
  width: 260px;
  height: 100%;
  box-sizing: border-box; 
  background-color: rgba(255, 245, 250, 0.96);
  padding: 40px 25px;
  box-shadow: 8px 0 15px rgba(0, 0, 0, 0.1);
  transition: left 0.4s ease;
  z-index: 1000;
  font-family: 'Press Start 2P', cursive;
  overflow-y: auto;
}

#sidebar a {
  display: block;
  margin: 30px 0;         
  font-size: 14px;        
  line-height: 1.8;  
   text-align: center;       
  color: #c94f7c;
  text-decoration: none;
  transition: transform 0.2s ease;
}

#sidebar a:hover {
  transform: translateX(5px);
  color: #ff6f91;
}

.theme-toggle {
  position: fixed;
  top: 15px;
  right: 15px;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  border: none;
  background: #fff0f5;
  color: #ff6f91;
  box-shadow: 4px 4px 12px rgba(0,0,0,0.15);
  cursor: pointer;
  font-size: 18px;
  z-index: 1101;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  transition: background 0.3s ease, transform 0.2s ease;
}

.theme-toggle:hover {
  transform: scale(1.05);
  background: #ffe4ec;
}

.theme-toggle .icon {
  position: absolute;
  opacity: 1;
  transition: opacity 0.3s ease;
}

.theme-toggle .sun {
  opacity: 0;
}

body.dark-mode {
  background-image: url('darkbg.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  color: #f2f2f2;
}

body.dark-mode .theme-toggle {
  background: #333;
  color: #ffe4ec;
}

body.dark-mode .theme-toggle .sun {
  opacity: 1;
}

body.dark-mode .theme-toggle .icon:first-child {
  opacity: 0;
}

body.dark-mode,
body.dark-mode p,
body.dark-mode h1,
body.dark-mode h2,
body.dark-mode h3,
body.dark-mode h4,
body.dark-mode h5,
body.dark-mode h6,
body.dark-mode label,
body.dark-mode .profile-username,
body.dark-mode .profile-level,
body.dark-mode .stat-item,
body.dark-mode .choose-avatar-title,
body.dark-mode .avatar-options,
body.dark-mode .login-box input::placeholder {
  color: #ffffff !important;
}

body.dark-mode .login-box,
body.dark-mode .profile-page,
body.dark-mode .task-container,
body.dark-mode .custom-box {
  background-color: rgba(0, 12, 52, 0.9);
  color: #f2f2f2;
  box-shadow: none;
  border: 2px solid #ff88aa;
}

body.dark-mode input,
body.dark-mode button {
  background-color: #222;
  color: #eee;
  border: 1px solid #555;
  box-shadow: inset 2px 2px 6px #111, inset -2px -2px 6px #444;
}

body.dark-mode .profile-stats .stat-item,
body.dark-mode .avatar-option,
body.dark-mode #sidebar {
  background-color: rgba(40, 40, 40, 0.95);
  color: #eee;
  border-color: #dd003f;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
}

body.dark-mode a {
  color: #ff99c9;
}
body.dark-mode a:hover {
  color: #ffc0cb;
}

body.dark-mode .history-box {
  background-color: rgba(0, 12, 52, 0.95);
  color: #ffffff;
  border: 2px solid #ff88aa;
  box-shadow: 0 0 15px rgba(255, 105, 135, 0.2);
}

body.dark-mode thead {
  background-color: #dd005f;
  color: #fff;
}

body.dark-mode tbody tr {
  background-color: rgba(30, 30, 45, 0.9);
}

body.dark-mode tbody tr:nth-child(even) {
  background-color: rgba(45, 45, 60, 0.9);
}

body.dark-mode thead th,
body.dark-mode tbody td {
  border: 1px solid #444;
  color: #fff;
}


body.dark-mode .no-history-message {
  color: #ccc;
}

    </style>
</head>
<body>
<img src="star-removebg-preview.png" id="menuToggle" alt="Menu" onclick="toggleSidebar()">
<button id="themeToggle" class="theme-toggle" aria-label="Toggle Dark Mode">
  <span class="icon">üåô</span>
  <span class="icon sun">‚òÄÔ∏è</span>
</button>

<div id="sidebar">
  <a href="index.html">Login</a>
<a href="userprofile.html">Profile</a>
     <a href="tasks.html">Tasks</a>
    <a href="focus.html">Timer</a>
    <a href="custom.html">Custom Timer</a>
    <a href="history.html">History</a>
    <a href="goals.html">Goals</a>
    <a href="motivational.html">Motivation</a>
  <a href="about.html">About</a>
</div>
    
    <div class="history-box">
        <div class="page-title">History üå∏</div>

        <table>
            <thead>
                <tr>
                    <th>Task</th>
                    <th>Session Type</th>
                    <th>Duration</th>
                    <th>Date</th>
                </tr>
            </thead>
            <tbody id="historyTableBody">
             
            </tbody>

        </table>
                <div id="noHistoryMessage" class="no-history-message" style="display: none;">
    No history found üå±
</div>

    </div>

  
   <script>
function loadHistory() {
    fetch('get_history.php', {
        method: 'GET',
        credentials: 'include'
    })
    .then(response => response.json())
    .then(data => {
        console.log("Fetched history data:", data); 

        const tbody = document.getElementById('historyTableBody');
        tbody.innerHTML = '';

        if (!Array.isArray(data) || data.length === 0 || data.error) {
            document.getElementById('noHistoryMessage').style.display = 'block';
            return;
        }

        document.getElementById('noHistoryMessage').style.display = 'none';

        data.forEach(entry => {
            const row = document.createElement('tr');

            const sessionType = {
                'work': 'Work',
                'short_break': 'Short Break',
                'long_break': 'Long Break'
            }[entry.session_type] || entry.session_type;

            const mins = Math.floor(entry.duration / 60);
            const secs = entry.duration % 60;
            const durationFormatted = `${mins}m ${secs}s`;

            const date = new Date(entry.timestamp).toLocaleDateString('en-GB');

            row.innerHTML = `
                <td>${entry.task_name || 'Untitled'}</td>
                <td>${sessionType}</td>
                <td>${durationFormatted}</td>
                <td>${date}</td>
            `;

            tbody.appendChild(row);
        });
    })
    .catch(error => {
        console.error('Error fetching history:', error);
        document.getElementById('noHistoryMessage').style.display = 'block';
    });
}

let sidebarOpen = false;
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebarOpen = !sidebarOpen;
    sidebar.style.left = sidebarOpen ? '0' : '-260px';
}

window.addEventListener('DOMContentLoaded', loadHistory);

const toggleButton = document.getElementById('themeToggle');
  const currentTheme = localStorage.getItem('theme');

  if (currentTheme === 'dark') {
    document.body.classList.add('dark-mode');
  }

  toggleButton.addEventListener('click', () => {
    const isDark = document.body.classList.toggle('dark-mode');
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
  });
</script>



</body>
</html>
